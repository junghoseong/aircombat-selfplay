
 Load selfplay opponents: Algo fsp, num_opponents 1.
/home/son/kai_ai/aircombat-selfplay/checkpoint/1v1_actor.pt
Traceback (most recent call last):
  File "/home/son/kai_ai/aircombat-selfplay/scripts/train/train_jsbsim.py", line 170, in main
    runner.run()
  File "/home/son/kai_ai/aircombat-selfplay/runner/jsbsim_runner.py", line 49, in run
    values, actions, action_log_probs, rnn_states_actor, rnn_states_critic = self.collect(step)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/son/kai_ai/aircombat-selfplay/runner/selfplay_jsbsim_runner.py", line 93, in collect
    = policy.act(np.concatenate(self.opponent_obs[env_idx]),
  File "/home/son/kai_ai/aircombat-selfplay/algorithms/ppo/ppo_policy.py", line 56, in act
    actions, _, rnn_states_actor = self.actor(obs, rnn_states_actor, masks, deterministic)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/son/kai_ai/aircombat-selfplay/algorithms/ppo/ppo_actor.py", line 57, in forward
    actions, action_log_probs = self.act(actor_features, deterministic, alpha0=alpha0, beta0=beta0)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/son/kai_ai/aircombat-selfplay/algorithms/utils/act.py", line 116, in forward
    shoot_action_log_prob = shoot_action_dist.log_probs(shoot_action)
  File "/home/son/kai_ai/aircombat-selfplay/algorithms/utils/distributions.py", line 52, in log_probs
    return super().log_prob(actions).sum(-1, keepdim=True)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/distributions/bernoulli.py", line 110, in log_prob
    logits, value = broadcast_all(self.logits, value)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/distributions/utils.py", line 126, in __get__
    value = self.wrapped(instance)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/distributions/bernoulli.py", line 92, in logits
    return probs_to_logits(self.probs, is_binary=True)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/site-packages/torch/distributions/utils.py", line 106, in probs_to_logits
    return torch.log(ps_clamped) - torch.log1p(-ps_clamped)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/son/kai_ai/aircombat-selfplay/scripts/train/train_jsbsim.py", line 183, in <module>
    main(sys.argv[1:])
  File "/home/son/kai_ai/aircombat-selfplay/scripts/train/train_jsbsim.py", line 175, in main
    envs.close()
  File "/home/son/kai_ai/aircombat-selfplay/envs/env_wrappers.py", line 110, in close
    self.close_extras()
  File "/home/son/kai_ai/aircombat-selfplay/envs/env_wrappers.py", line 297, in close_extras
    remote.send(('close', None))
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/home/son/anaconda3/envs/rl_exp/lib/python3.10/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe